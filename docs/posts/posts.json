[
  {
    "path": "posts/2021-12-01-eds-222-final-project-species-density-sst/",
    "title": "EDS 222 Final Project - Species Density ~ SST",
    "description": "A short description of the post.",
    "author": [
      {
        "name": "Cullen Molitor",
        "url": {}
      }
    ],
    "date": "2021-12-01",
    "categories": [],
    "contents": "\r\n\r\nContents\r\nMotivation\r\nData\r\nAnalysis\r\nModel\r\n\r\nResults\r\nFuture Work\r\nLiterature Cited\r\n\r\nMotivation\r\nMotivate your question. Why is this important? Is there existing evidence on this question? If so, why is it inconclusive? If not, why not?\r\nCalifornia’s Northern Channel Islands sit at the transition between two biogeographic provinces, the cold-water North Pacific and the warmer Gulf of California to the south. San Miguel and Santa Rosa Islands have species representative of the colder North Pacific province while Anacapa and Santa Barbara Islands sit firmly in the warmer Gulf of California province. Santa Cruz Island lies in the transition zone with the western end of the island favoring North Pacific species and the eastern end favoring Gulf of California species. This makes the Northern Channel Islands a unique place to study how species distributions respond to ocean temperatures.\r\nThe water temperatures of the Southern California Bight (SCB) and the Channel Islands are influenced by the El Niño Southern Oscillation (ENSO). ENSO to sea surface temperatures (SST) from.\r\nThe impetus of this analysis is to investigate which species are sensitive to either warm-water or cold-water events. Using a series of dynamic linear model with lag independent variables (SST anomalies)\r\nData\r\nDescribe your data. Where did you access it? What are its spatial and temporal features? What are its limitations? What do you know about the sampling strategy and what biases that may introduce? If helpful, you can use a histogram, scatterplot, or summary statistics table to describe your data.\r\nThe Kelp Forest Monitoring (KFM) program at Channel Islands National Park has been collecting abundance and size distribution data of more than 150 species for nearly 40 years (sampled annually) of 37 sites at the five Islands in the National Park.\r\nUsing species density, we can see the trends observed over multiple El Niño (warm-water) and La Niña (cold-water) events. Using a dynamic linear model with lag independent variables we can see the effect of sea surface temperature anomalies during and in the years following these events. recruitment of certain species either increases or decreases.\r\n\r\n\r\nhide\r\n\r\nknitr::opts_chunk$set(echo = TRUE)\r\n# Load libraries\r\nlibrary(tidyverse)\r\nlibrary(here)\r\nlibrary(broom)\r\nlibrary(tsibble)\r\nlibrary(dLagM)\r\nlibrary(arrow)\r\nlibrary(lubridate)\r\n\r\n# Load and Tidy Data\r\noni_yearly <- read.table( # Read in  ONI to be added to all data\r\n  \"https://origin.cpc.ncep.noaa.gov/products/analysis_monitoring/ensostuff/detrend.nino34.ascii.txt\",\r\n  header = T) %>%\r\n  dplyr::mutate(Date = as.Date(ISOdate(YR, MON, 1)),\r\n                DateStart = as.Date(ISOdate(YR, MON, 1)),\r\n                DateEnd = ceiling_date(DateStart, \"month\")) %>%\r\n  dplyr::rename(SST_Anom = ANOM,\r\n                Month = MON,\r\n                SurveyYear = YR) %>% \r\n  dplyr::select(SurveyYear, Month, Date, DateStart, DateEnd, SST_Anom) %>% \r\n  dplyr::group_by(SurveyYear) %>% \r\n  dplyr::summarise(SST_Anom = mean(SST_Anom)) %>% \r\n  dplyr::mutate(SST_Anom_1 = lag(SST_Anom, n = 1),\r\n                SST_Anom_2 = lag(SST_Anom, n = 2),\r\n                SST_Anom_3 = lag(SST_Anom, n = 3),\r\n                SST_Anom_4 = lag(SST_Anom, n = 4),\r\n                SST_Anom_5 = lag(SST_Anom, n = 5))\r\n\r\nSpecies_Info <- readr::read_csv(\"Species_Complete.csv\")\r\n\r\nSite_Info <- readr::read_csv(\"Site_Info.csv\")\r\n\r\ndensity <- arrow::read_feather(\"Density.feather\") %>%\r\n  dplyr::filter(Classification != \"Fish\",\r\n                !CommonName %in% c(\"wakame, adult\", \"wakame, juvenile\", \"white abalone\")) %>% \r\n  dplyr::left_join(oni_yearly)\r\n\r\n\r\n\r\nAnalysis\r\nClearly describe your analysis plan. What is your analysis plan? Why did you choose this analysis, given your data and question? What are the limitations?\r\nModel\r\n\r\n\r\nhide\r\n\r\nResults_lag <- density %>% \r\n  dplyr::group_by(ScientificName) %>% \r\n  dplyr::summarise(\r\n    generics::tidy(\r\n      stats::lm(\r\n        Mean_Density ~ SST_Anom + SST_Anom_1 + SST_Anom_2 + SST_Anom_3 + SST_Anom_4 + SST_Anom_5\r\n        ))) %>% \r\n  # tidyr::drop_na(p.value) %>%\r\n  dplyr::filter(term != \"(Intercept)\") %>% \r\n  dplyr::mutate(significant = ifelse(p.value <= .05, \"yes\", \"no\"))\r\n\r\nResults_filtered <- Results_lag %>%\r\n  dplyr::filter(p.value <= .05) %>% \r\n  dplyr::arrange(estimate) %>%\r\n  # dplyr::arrange(p.value) %>%\r\n  dplyr::mutate(statistic = round(statistic, 3),\r\n                p.value = round(p.value, 3),\r\n                p.value = ifelse(p.value < 0.001, \"< 0.001\", as.character(p.value))) \r\n\r\n\r\n\r\nResults\r\nSummarize your results visually and in words. Show us your results in figure(s) and/or table(s) that are carefully labeled and captioned. Describe in the text (and orally when presenting) what you found, and how these results either do or do not help you answer your question.\r\n\r\n\r\nhide\r\n\r\nprop <- Results_lag %>% \r\n  group_by(ScientificName) %>%\r\n  summarise(est_sum =  sum(estimate)) \r\n  \r\n\r\ntotal <- length(Results_lag$ScientificName)\r\nwarm <- Results_lag %>%\r\n  filter(estimate > 0) %>% \r\n  # distinct(CommonName) %>% \r\n  pull(ScientificName) %>% \r\n  length()\r\ncold <- Results_lag %>%\r\n  filter(estimate < 0) %>% \r\n  # distinct(CommonName) %>% \r\n  pull(ScientificName) %>% \r\n  length()\r\n\r\n\r\n\r\n\r\n\r\nhide\r\n\r\nggplot(data = prop, aes(x = est_sum)) +\r\n  geom_density() +\r\n  xlim(c(-2, 2))\r\n\r\n\r\n\r\n\r\n\r\n\r\nhide\r\n\r\n# for (sp in unique(Results_filtered$CommonName)) {\r\n#   p <- density %>% \r\n#     filter(CommonName == sp) %>% \r\n#     ggplot(aes(y = Mean_Density)) +\r\n#     # geom_point() +\r\n#     geom_smooth(aes(x = SST_Anom), se = F, method = lm, formula = \"y~x\",color = \"red\") +\r\n#     geom_smooth(aes(x = SST_Anom_1), se = F, method = lm, formula = \"y~x\", color = \"blue\") +\r\n#     geom_smooth(aes(x = SST_Anom_2), se = F, method = lm, formula = \"y~x\", color = \"green\") +\r\n#     geom_smooth(aes(x = SST_Anom_3), se = F, method = lm, formula = \"y~x\", color = \"black\") +\r\n#     geom_smooth(aes(x = SST_Anom_4), se = F, method = lm, formula = \"y~x\", color = \"purple\") +\r\n#     labs(title = sp) +\r\n#     theme_classic()\r\n#   \r\n#   print(p)\r\n# }\r\n\r\n\r\n\r\n\r\n\r\nhide\r\n\r\n# for (sp in unique(Results_filtered$CommonName)) {\r\n#   p <- Results_lag %>% \r\n#     filter(CommonName == sp) %>% \r\n#     ggplot() +\r\n#     geom_line(aes(x = term, y = estimate, color = CommonName, group = CommonName), show.legend = F) +\r\n#     geom_point(aes(x = term, y = estimate, shape = significant), size = 4) +\r\n#     labs(title = sp) +\r\n#     theme_classic()\r\n#   \r\n#   print(p)\r\n# }\r\n\r\n\r\n\r\nFuture Work\r\nWhat might you do next? One short analysis cannot fully answer an interesting scientific question. If you had time to collect more data or conduct more analysis, what would help you answer this question better?\r\nLiterature Cited\r\nCostello, M.J., Tsai, P., Wong, P.S. et al. Marine biogeographic realms and species endemicity. Nat Commun 8, 1057 (2017). https://doi.org/10.1038/s41467-017-01121-2\r\nRyan Freidman\r\n\r\n\r\n\r\n",
    "preview": "posts/2021-12-01-eds-222-final-project-species-density-sst/eds-222-final-project-species-density-sst_files/figure-html5/unnamed-chunk-3-1.png",
    "last_modified": "2021-12-01T12:54:11-08:00",
    "input_file": {}
  }
]
