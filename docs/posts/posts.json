[
  {
    "path": "posts/2021-12-01-eds-222-final-project-species-density-sst/",
    "title": "Species Density ~ SST + lag(SST)\n",
    "description": {},
    "author": [
      {
        "name": "Cullen Molitor",
        "url": {}
      }
    ],
    "date": "2021-12-01",
    "categories": [],
    "contents": "\r\n\r\nContents\r\nEDS 222 Final Project\r\nMotivation\r\nData\r\nAnalysis\r\nModel\r\n\r\nResults\r\nFuture Work\r\nBetter Models\r\n\r\nLiterature Cited\r\n\r\n\r\nEDS 222 Final Project\r\nMotivation\r\nCalifornia’s Northern Channel Islands sit at the transition between two biogeographic provinces, the cold-water North Pacific and the warm-water Gulf of California to the south. San Miguel and Santa Rosa Islands have species representative of the North Pacific province while Anacapa and Santa Barbara Islands sit firmly in the Gulf of California province. Santa Cruz Island lies in the transition zone with the western end of the island favoring North Pacific species and the eastern end favoring Gulf of California species. This makes the Northern Channel Islands a unique place to study how species distributions respond to ocean temperatures.\r\n\r\n\r\nhide\r\n\r\nknitr::include_graphics(\"biogeo.png\")\r\n\r\n\r\n\r\n\r\n\r\nThe El Niño Southern Oscillation (ENSO) is measured primarily by the Oceanic Niño Index which calculates an anomaly value for each month going back to 1950. These values are derived from SST in the equatorial pacific (\\(\\pm5^{\\circ}\\) latitude, \\(120^{\\circ}-170^{\\circ}W\\) longitude). The oscillation seen in SST of this region is responsible for driving certain global weather and climate patterns. Despite the distance from this region, ENSO has a large effect on the oceanographic conditions of the SCB and the Channel Islands. This effect includes an influence on local SST as well as the strength and direction of ocean currents. These effects are known to influence the distribution and abundance of certain marine species (Day 2018, Freedman 2020).\r\nThis analysis takes a shotgun approach to investigate which species are sensitive to either warm-water or cold-water events by using a series of species level dynamic linear model with lag SST anomalies variables. These models can will provide a broad overview of which species are affected, how they are affected, and whether or not the affect is statistically significant.\r\nData\r\nThe Kelp Forest Monitoring (KFM) program at Channel Islands National Park has been collecting abundance and size distribution data of more than 170 species since 1982 (sampled annually). The park currently samples 33 sites at the five islands in the National Park. This data is publicly available and was requested and issued under a scientific research and collecting permit (permit #: CHIS-2020-SCI-0006). These data are collected using scuba surveys and the biologists attempt to minimize their impact on the reef by using non-invasive sampling methods. This means that animals are counted in situ and no rocks are overturned. This inevitably biases the data towards adult populations of certain invertebrates that utilize crevice habitat during development.\r\nThe fish data is collected in (#\\(/m^3\\)). In order to assure that all data are in the same units, only measurements of invertebrate and algae density (#\\(/m^2\\)) are retained. This takes the total number of species with density data from 151 down to 35.\r\nUsing species density, we can see the trends observed over multiple El Niño (warm-water) and La Niña (cold-water) events. Using a dynamic linear model with lag independent variables we can see the effect of sea surface temperature anomalies during and in the years following these events on species density. recruitment of certain species either increases or decreases.\r\n\r\n\r\nhide\r\n\r\n# Load libraries\r\nlibrary(tidyverse)\r\nlibrary(here)\r\nlibrary(broom)\r\nlibrary(tsibble)\r\nlibrary(dLagM)\r\nlibrary(arrow)\r\nlibrary(lubridate)\r\n\r\n# Load and Tidy Data\r\noni_yearly <- read.table( # Read in  ONI to be added to all data\r\n  \"https://origin.cpc.ncep.noaa.gov/products/analysis_monitoring/ensostuff/detrend.nino34.ascii.txt\",\r\n  header = T) %>%\r\n  dplyr::mutate(Date = as.Date(ISOdate(YR, MON, 1)),\r\n                DateStart = as.Date(ISOdate(YR, MON, 1)),\r\n                DateEnd = ceiling_date(DateStart, \"month\")) %>%\r\n  dplyr::rename(SST_Anom = ANOM,\r\n                Month = MON,\r\n                SurveyYear = YR) %>% \r\n  dplyr::select(SurveyYear, Month, Date, DateStart, DateEnd, SST_Anom) %>% \r\n  dplyr::group_by(SurveyYear) %>% \r\n  dplyr::summarise(SST_Anom = mean(SST_Anom)) %>% \r\n  dplyr::mutate(SST_Anom_1 = lag(SST_Anom, n = 1),\r\n                SST_Anom_2 = lag(SST_Anom, n = 2),\r\n                SST_Anom_3 = lag(SST_Anom, n = 3),\r\n                SST_Anom_4 = lag(SST_Anom, n = 4),\r\n                SST_Anom_5 = lag(SST_Anom, n = 5))\r\n\r\nSpecies_Info <- readr::read_csv(\"Species_Complete.csv\")\r\n\r\nSite_Info <- readr::read_csv(\"Site_Info.csv\")\r\n\r\ndensity <- arrow::read_feather(\"Density.feather\") %>%\r\n  dplyr::filter(Classification != \"Fish\",\r\n                !CommonName %in% c(\"wakame, adult\", \"wakame, juvenile\", \"white abalone\")) %>% \r\n  dplyr::left_join(oni_yearly)\r\n\r\n\r\n\r\nAnalysis\r\nClearly describe your analysis plan. What is your analysis plan? Why did you choose this analysis, given your data and question? What are the limitations?\r\nModel\r\ntext\r\n\r\n\r\nhide\r\n\r\nResults_lag <- density %>% \r\n  dplyr::group_by(ScientificName) %>%\r\n  dplyr::summarise(\r\n    generics::tidy(\r\n      stats::lm(\r\n        Mean_Density ~ SST_Anom + SST_Anom_1 + SST_Anom_2 + SST_Anom_3 + SST_Anom_4 + SST_Anom_5\r\n        ))) %>% \r\n  # tidyr::drop_na(p.value) %>%\r\n  dplyr::filter(term != \"(Intercept)\") %>% \r\n  dplyr::mutate(significant = ifelse(p.value <= .05, \"yes\", \"no\"))\r\n\r\nResults_filtered <- Results_lag %>%\r\n  dplyr::filter(p.value <= .05) %>% \r\n  dplyr::arrange(estimate) %>%\r\n  # dplyr::arrange(p.value) %>%\r\n  dplyr::mutate(statistic = round(statistic, 3),\r\n                p.value = round(p.value, 3),\r\n                p.value = ifelse(p.value < 0.001, \"< 0.001\", as.character(p.value))) \r\n\r\n\r\n\r\nResults\r\nSummarize your results visually and in words. Show us your results in figure(s) and/or table(s) that are carefully labeled and captioned. Describe in the text (and orally when presenting) what you found, and how these results either do or do not help you answer your question.\r\n\r\n\r\nhide\r\n\r\nprop <- Results_lag %>% \r\n  group_by(ScientificName) %>%\r\n  summarise(est_sum =  sum(estimate)) \r\n  \r\n\r\ntotal <- length(Results_lag$ScientificName)\r\nwarm <- Results_lag %>%\r\n  filter(estimate > 0) %>% \r\n  # distinct(CommonName) %>% \r\n  pull(ScientificName) %>% \r\n  length()\r\ncold <- Results_lag %>%\r\n  filter(estimate < 0) %>% \r\n  # distinct(CommonName) %>% \r\n  pull(ScientificName) %>% \r\n  length()\r\n\r\n\r\n\r\n\r\n\r\nhide\r\n\r\nggplot(data = prop, aes(x = est_sum)) +\r\n  geom_density() +\r\n  xlim(c(-2, 2))\r\n\r\n\r\n\r\n\r\n\r\n\r\nhide\r\n\r\n# for (sp in unique(Results_filtered$CommonName)) {\r\n#   p <- density %>% \r\n#     filter(CommonName == sp) %>% \r\n#     ggplot(aes(y = Mean_Density)) +\r\n#     # geom_point() +\r\n#     geom_smooth(aes(x = SST_Anom), se = F, method = lm, formula = \"y~x\",color = \"red\") +\r\n#     geom_smooth(aes(x = SST_Anom_1), se = F, method = lm, formula = \"y~x\", color = \"blue\") +\r\n#     geom_smooth(aes(x = SST_Anom_2), se = F, method = lm, formula = \"y~x\", color = \"green\") +\r\n#     geom_smooth(aes(x = SST_Anom_3), se = F, method = lm, formula = \"y~x\", color = \"black\") +\r\n#     geom_smooth(aes(x = SST_Anom_4), se = F, method = lm, formula = \"y~x\", color = \"purple\") +\r\n#     labs(title = sp) +\r\n#     theme_classic()\r\n#   \r\n#   print(p)\r\n# }\r\n\r\n\r\n\r\n\r\n\r\nhide\r\n\r\n# for (sp in unique(Results_filtered$CommonName)) {\r\n#   p <- Results_lag %>% \r\n#     filter(CommonName == sp) %>% \r\n#     ggplot() +\r\n#     geom_line(aes(x = term, y = estimate, color = CommonName, group = CommonName), show.legend = F) +\r\n#     geom_point(aes(x = term, y = estimate, shape = significant), size = 4) +\r\n#     labs(title = sp) +\r\n#     theme_classic()\r\n#   \r\n#   print(p)\r\n# }\r\n\r\n\r\n\r\nFuture Work\r\nWhat might you do next? One short analysis cannot fully answer an interesting scientific question. If you had time to collect more data or conduct more analysis, what would help you answer this question better?\r\nBetter Models\r\nInclude biogeogrphic regions to see how species distribution is affected. ## More Protocols/Species This analysis only uses 2 out of 13 sampling protocols of the KFM program. The analysis could be expanded to include data from the two fish surveys, as well as percent cover data from random point contacts survey.\r\n## Integrate Program Data This analysis could be made more robust by including data from the Partnership for Interdisciplinary Study of Coastal Oceans (PISCO), which conducts similar monitoring efoorts around the Channel Islands.\r\nLiterature Cited\r\nCostello, M.J., Tsai, P., Wong, P.S. et al. Marine biogeographic realms and species endemicity. Nat Commun 8, 1057 (2017). https://doi.org/10.1038/s41467-017-01121-2\r\nDay, P. B., Stuart-Smith, R. D., Edgar, G. J. & Bates, A. E. Species’ thermal ranges predict changes in reef fish community structure during 8 years of extreme temperature variation. Divers. Distrib. 24, 1036–1046 (2018).\r\nFreedman, R.M., Brown, J.A., Caldow, C. et al. Marine protected areas do not prevent marine heatwave-induced fish community structure changes in a temperate transition zone. Sci Rep 10, 21081 (2020). https://doi.org/10.1038/s41598-020-77885-3\r\nHorta e Costa, B. Tropicalization of fish assemblages in temperate biogeographic transition zones. Mar. Ecol. Prog. Ser. 504, 241–252 (2014).\r\nWernberg, T. S. et al. Climate-driven regime shift of a temperate marine ecosystem. Science 353, 169–172 (2016).\r\n\r\n\r\n\r\n\r\n\r\n\r\n",
    "preview": "posts/2021-12-01-eds-222-final-project-species-density-sst/biogeo.png",
    "last_modified": "2021-12-01T19:43:49-08:00",
    "input_file": {}
  }
]
